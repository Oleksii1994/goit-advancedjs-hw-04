{"version":3,"file":"commonHelpers.js","sources":["../src/js/anchor-scroll.js","../src/js/image-api.js","../src/js/helpers.js","../src/js/main.js"],"sourcesContent":["import $ from 'jquery';\n\nconst upBtn = document.querySelector('.up-button');\n\n$(document).ready(function () {\n  // Add smooth scrolling to all links\n  $('a').on('click', function (event) {\n    // Make sure this.hash has a value before overriding default behavior\n    if (this.hash !== '') {\n      // Prevent default anchor click behavior\n      event.preventDefault();\n\n      // Store hash\n      var hash = this.hash;\n\n      // Using jQuery's animate() method to add smooth page scroll\n      // The optional number (800) specifies the number of milliseconds it takes to scroll to the specified area\n      $('html, body').animate(\n        {\n          scrollTop: $(hash).offset().top,\n        },\n        //duration\n        700,\n        function () {\n          upBtn.classList.add('is-hidden');\n          // Add hash (#) to URL when done scrolling (default click behavior)\n          window.location.hash = hash;\n        }\n      );\n    }\n  });\n});\n","import axios from 'axios';\n\nconst API_KEY = '34183699-29109d6fbf2dd60241f6d6e15';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchImages = async (searchQuery, page) => {\n  const { data } = await axios.get(\n    `${BASE_URL}?key=${API_KEY}&q=${searchQuery}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${page}`\n  );\n  if (!data) {\n    throw new Error();\n  }\n\n  return data;\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function createMarkup(arrayOfImages) {\n  const markup = arrayOfImages\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        tags,\n      }) => `<li class=\"photo-card gallery__item\" data-aos=\"fade-up\"\n     data-aos-anchor-placement=\"center-bottom\" data-aos-duration=\"1500\" >\n    <a class=\"gallery__link\" href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery__image\" loading=\"lazy\" width=\"380\"/></a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b>\n            ${likes}\n        </p>\n            <p class=\"info-item\">\n        <b>Views</b>\n        ${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>\n            ${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>\n            ${downloads}\n        </p>\n    </div>\n</li>`\n    )\n    .join('');\n  return markup;\n}\n\nexport function isBottomReached() {\n  const scrollTop = window.scrollY;\n  const windowHeight = window.innerHeight;\n  const documentHeight = document.documentElement.offsetHeight;\n  return scrollTop + windowHeight >= documentHeight - 30; // Буфер 10px\n}\n\nexport function isUpButtonShow() {\n  const scrollTop = window.scrollY;\n  const windowHeight = window.innerHeight;\n  const documentHeight = document.documentElement.offsetHeight;\n  return scrollTop + windowHeight >= documentHeight / 3; // Буфер 10px\n}\n\nexport function createWarningMessage(message) {\n  iziToast.warning({\n    message,\n    position: 'topRight',\n  });\n}\n\nexport function createInfoMessage(message) {\n  iziToast.info({\n    message,\n    position: 'topRight',\n  });\n}\n\nexport function createSuccessMessage(message) {\n  iziToast.success({\n    message,\n    position: 'topRight',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport debounce from 'lodash.debounce';\nimport AOS from 'aos';\nimport 'aos/dist/aos.css';\nimport './anchor-scroll';\n\nimport { fetchImages } from './image-api';\nimport {\n  createMarkup,\n  isBottomReached,\n  isUpButtonShow,\n  createWarningMessage,\n  createInfoMessage,\n  createSuccessMessage,\n} from './helpers';\n\nAOS.init();\n\nconst searchForm = document.getElementById('search-form');\nconst loader = document.querySelector('.loader-container');\nconst gallery = document.querySelector('.gallery');\nconst upBtn = document.querySelector('.up-button');\n\nlet previousQueryToSearch = '';\nconst perPage = 40;\nlet page = 1;\nlet simpleLightbox = null;\nlet loading = false;\nlet totalNumberOfHits;\nlet numberOfHitsOnLoad = 0;\n\nloader.classList.add('is-hidden');\ngallery.classList.add('is-hidden');\n\nfunction checkIfNewSearchQuery(newValue) {\n  if (!newValue.trim()) {\n    createWarningMessage(\"Sorry, search field can't be empty.\");\n    loader.classList.add('is-hidden');\n\n    throw new Error();\n  }\n\n  if (newValue === previousQueryToSearch) {\n    createWarningMessage('Try to find images by another word.');\n\n    throw new Error();\n  }\n\n  if (newValue !== previousQueryToSearch) {\n    previousQueryToSearch = newValue;\n    loader.classList.remove('is-hidden');\n    gallery.classList.add('is-hidden');\n    gallery.innerHTML = '';\n  }\n}\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  numberOfHitsOnLoad = 0;\n  const { value } = event.currentTarget.elements.searchQuery;\n\n  page = 1;\n\n  try {\n    checkIfNewSearchQuery(value.trim());\n\n    const { hits, totalHits } = await fetchImages(value.trim(), page);\n\n    if (!hits || hits.length === 0) {\n      createWarningMessage(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      event.target.elements.searchQuery.value = '';\n      loader.classList.add('is-hidden');\n      return;\n    }\n\n    numberOfHitsOnLoad = hits.length;\n    totalNumberOfHits = totalHits;\n    if (totalHits <= perPage) {\n      setTimeout(\n        () =>\n          createInfoMessage(\n            \"We're sorry, but not a lot of images was founded by this search word.\"\n          ),\n        3000\n      );\n    }\n\n    createSuccessMessage(`Hooray! We found ${totalHits} images`);\n\n    loader.classList.add('is-hidden');\n\n    gallery.classList.remove('is-hidden');\n    gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n    simpleLightbox = new SimpleLightbox('.gallery__link', {\n      captionDelay: 250,\n      captionsData: 'alt',\n      scrollZoom: false,\n    });\n\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight / 3,\n      behavior: 'smooth',\n    });\n\n    event.target.elements.searchQuery.value = '';\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function loadMore() {\n  if (loading) {\n    return;\n  }\n\n  loading = true;\n  page += 1;\n\n  try {\n    loader.classList.remove('is-hidden');\n    const { hits, totalHits } = await fetchImages(previousQueryToSearch, page);\n    numberOfHitsOnLoad += hits.length;\n\n    const totalPages = Math.ceil(totalHits / perPage);\n\n    if (totalPages === page) {\n      createInfoMessage(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n\n      loading = false;\n    }\n\n    gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n    loader.classList.add('is-hidden');\n\n    loading = false;\n    simpleLightbox.refresh();\n  } catch (error) {\n    console.log(error.message);\n  }\n}\n\nfunction onScrollLoadMore() {\n  if (isUpButtonShow()) {\n    upBtn.classList.remove('is-hidden');\n  }\n\n  if (numberOfHitsOnLoad >= totalNumberOfHits) {\n    loader.classList.add('is-hidden');\n    return;\n  }\n\n  if (isBottomReached() && !loading) {\n    loadMore();\n  }\n}\n\nwindow.addEventListener('scroll', debounce(onScrollLoadMore, 100));\nsearchForm.addEventListener('submit', handleSubmit);\n"],"names":["upBtn","$","event","hash","API_KEY","BASE_URL","fetchImages","searchQuery","page","data","axios","createMarkup","arrayOfImages","webformatURL","largeImageURL","likes","views","comments","downloads","tags","isBottomReached","scrollTop","windowHeight","documentHeight","isUpButtonShow","createWarningMessage","message","iziToast","createInfoMessage","createSuccessMessage","AOS","searchForm","loader","gallery","previousQueryToSearch","perPage","simpleLightbox","loading","totalNumberOfHits","numberOfHitsOnLoad","checkIfNewSearchQuery","newValue","handleSubmit","value","hits","totalHits","SimpleLightbox","cardHeight","error","loadMore","onScrollLoadMore","debounce"],"mappings":"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"}